## מסמך אפיון מערכת (PRD) – Real Estate Agent

### 1. מטרת המוצר
מערכת Real Estate Agent מהווה פלטפורמה מקיפה לריכוז ואיחוד כל הנתונים הרלוונטיים על נכסים במקום אחד. המערכת מיועדת במיוחד למתווכים ושמאי נדל"ן, ומספקת להם שירות טכנולוגי מתקדם המבוסס על בינה מלאכותית (AI). המערכת מאפשרת איסוף אוטומטי של מידע מכלל המקורות הרלוונטיים (Yad2, מערכות ממשלתיות, GIS, ועוד), ניתוח חכם של הנתונים, והצגה אינטואיטיבית המאפשרת קבלת החלטות מהירות ומדויקות.

### 2. יעדים עיקריים
- **ריכוז נתונים מקיף**: איסוף ואיחוד מידע עדכני על נכסים מכלל המקורות הרלוונטיים (Yad2, gov.il, GIS, רשויות מקומיות).
- **שירות מהיר ויעיל למתווכים**: כלים לחיפוש מתקדם, השוואת נכסים, וניתוח שוק בזמן אמת.
- **תמיכה מתקדמת לשמאים**: נתוני השוואה מדויקים, היסטוריית מחירים, ונתוני רקע מפורטים על נכסים.
- **חיפוש חכם מבוסס AI**: שילוב עם מודלים שפתיים (LLM) לחיפוש בשפה טבעית ופענוח כוונות המשתמש.
- **אוטומציה וחיסכון בזמן**: התראות אוטומטיות, עדכונים בזמן אמת, ועיבוד נתונים ללא התערבות ידנית.
- **ממשק משתמש אינטואיטיבי**: דשבורד מקצועי לניהול מודעות, יצירת דוחות, וניתוח מגמות שוק.
- **יכולת הרחבה עתידית**: תמיכה בהוספת מקורות נתונים חדשים ושילוב עם מערכות חיצוניות.

### 3. קהלי יעד (Personas)
| פרסונה | צרכים מרכזיים | תועלת מהמערכת |
| --- | --- | --- |
| **מתווך נדל"ן** | ניהול מאגר נכסים, מציאת נכסים מתאימים ללקוחות, מעקב אחר שוק, יצירת התראות | ריכוז כל המידע במקום אחד, חיפוש חכם ומהיר, עדכונים אוטומטיים, כלי השוואה מתקדמים |
| **שמאי נדל"ן** | נתוני השוואה מדויקים, היסטוריית מחירים, מידע רקע על נכסים ואזורים | גישה לנתונים מקיפים מכל המקורות, ניתוח מגמות, דוחות מקצועיים, חיסכון בזמן איסוף נתונים |
| **משרד תיווך** | ניהול מספר מתווכים, דוחות ביצועים, ניתוח שוק אזורי | מערכת ניהול מרכזית, דשבורד ניהולי, אנליטיקה מתקדמת, אוטומציה של תהליכים |
| **משקיע/קונה פרטי** | מציאת נכס לפי קריטריונים, ניתוח מחירים, קבלת התראות | חיפוש פשוט ואינטואיטיבי, התראות ממוקדות, תמונת מצב שוק עדכנית |
| **מפתח/מנהל מערכת** | הרחבה קלה של המודולים, שילוב עם כלים חיצוניים, בדיקות אוטומטיות | ארכיטקטורה מודולרית, API נוח, תיעוד מפורט, כלי פיתוח |

### 4. תרחישי שימוש עיקריים

#### 4.1 תרחישים למתווכים
1. **חיפוש נכס עבור לקוח** – מתווך מקבל דרישות מלקוח ומחפש נכסים מתאימים באמצעות חיפוש חכם מבוסס AI.
2. **ניתוח שוק אזורי** – בדיקת מחירים, מגמות ותחזיות באזור ספציפי לצורך ייעוץ ללקוחות.
3. **ניהול מאגר נכסים** – עדכון מתמיד של רשימת הנכסים הזמינים, הסרת נכסים שנמכרו, הוספת נכסים חדשים.
4. **הגדרת התראות ללקוחות** – יצירת התראות אוטומטיות ללקוחות על נכסים חדשים העונים לקריטריונים שלהם.

#### 4.2 תרחישים לשמאים
1. **איסוף נתוני השוואה** – מציאת נכסים דומים (comparable properties) לצורך הערכת שווי נכס.
2. **ניתוח היסטורי של מחירים** – בדיקת מגמות מחירים באזור לאורך זמן לצורך הערכה מדויקת.
3. **יצירת דוח שמאות** – כלי ליצירת דוחות מקצועיים הכוללים נתונים מכל המקורות הרלוונטיים.
4. **בדיקת רקע נכס** – איסוף מידע מקיף על הנכס ממקורות ממשלתיים (זכויות בנייה, מגבלות, היסטוריה).

#### 4.3 תרחישים כלליים
1. **חיפוש בשפה טבעית** – המשתמש שולח שאילתה (לדוגמה: "דירות 4 חדרים בת״א עד 8 מיליון"), המערכת משתמשת ב-MCP+LLM ליצירת החיפוש.
2. **ניתוח מתקדם של תוצאות** – המערכת מספקת ניתוח סטטיסטי, גרפים, ומגמות על בסיס התוצאות שנמצאו.

### 5. גבולות והיקף
- גרסה ראשונית ממקדת בדומיין Yad2 והרחבה למקורות נוספים בעתיד.
- ה-MCP server מותאם בראש ובראשונה ל-LM Studio/Claude, אך ניתן להרחבה.
- GUI (Broker UI) בסביבה וובית Next.js.
- Backend נוסף לדשבורד – Django (אפשרויות ניהול והרחבות API).

### 6. דרישות פונקציונליות
#### 6.1 איסוף נתונים (Scraping & Fetching)
- תמיכה בפרמטרים: עיר, שכונה, סוג נכס, מספר חדרים, טווח מחיר, רמת גימור, חניה, מעלית, ועוד.
- אימות פרמטרים (validation) ויצירת URL תקין ל-Yad2.
- Rate limiting, רוטציה של user-agent, ועמידה ב-robots.txt.
- אפשרות לגישת GIS (לדוגמה: Tel Aviv ArcGIS) לצורך מידע מרחבי משלים.

#### 6.2 מודל הנתונים
- `RealEstateListing`: שדות כמו זיהוי, כותרת, מחיר, כתובת, מאפיינים, תמונות, מקור.
- שמירת תאריך איסוף, URL מקורי, סטטוס העדכון.
- נתוני מטה על החיפוש: פרמטרים, תיאור, תוצאות.

#### 6.3 שכבת לוגיקה וממשק CLI/MCP
- CLI אינטראקטיבי: ניווט לפי תפריטים, הגדרת פרמטרים, ביצוע חיפוש, תצוגת תוצאות.
- MCP server (FastAPI/FastMCP): כלים כמו `search_properties`, `get_search_parameters_reference`, `analyze_search_results`, `save_search_results`, `build_search_url`.
- הדגמת שימוש (yad2/examples/demo.py).

#### 6.4 ממשק ניהול – Broker Dashboard UI
- מבוסס Next.js.
- יכולות:
  - צפייה והסרת רשימות.
  - הגדרת התראות.
  - ניתוח משכנתא בסיסי.
  - תצוגה ויזואלית של גרפים (מחירי ממוצע, התפלגות).

#### 6.5 התממשקות למערכות ממשלתיות
- מודול gov/mcp: גישה ל-API של gov.il (לדוגמה – רישומי נכסים, מידע מסים).
- שימוש במסגרת MCP ככלי עזר לשאילתה מתוך LLM.

#### 6.6 ניתוח וייצוא
- `analyze_search_results`: קביעת ממוצעי מחיר, התפלגות לפי אזור/סוג נכס, גרפים.
- ייצוא: יצירת קובץ JSON הכולל metadata מלאה.

### 7. דרישות לא פונקציונליות
| תחום | דרישה |
| --- | --- |
| ביצועים | זמן תגובה סביר (עד 5 שניות/שאילתה), טיפול בעד 1,000 מודעות לשאילתה. |
| אבטחה | ניהול סודות (API keys), מניעת שימוש לא חוקי, הגבלת גישה. |
| סקלביליות | יכולת הרחבה למקורות נתונים/מודולים חדשים ללא שינוי ארכיטקטוני משמעותי. |
| אמינות | לוגים ויכולות retry בחיבור לאתרים. |
| תחזוקה | קוד מודולרי, בדיקות (pytest), תיעוד. |
| נגישות | ממשק CLI ברור, ווב: תאימות נייד/נייח. |

### 8. ארכיטקטורה ותרשים כללי
```
משתמש CLI / LLM ----> MCP Server ----> מודול yad2 (scraper + core)
                      |                 |
                      |                 +--> Utils (תצוגת URL, פיענוח)
                      |
                      +--> מודולי GIS ו-gov למידע משלים
                      
משתמש ווב (Broker UI) ----> Django Backend ----> DB (לדוגמה: PostgreSQL)
                            |
                            +--> שילוב עם מודול הגרפים/ניתוח
```

### 9. מודולים עיקריים (תקציר)
- **yad2/core** – פרמטרים, מודלים, Utilities.
- **yad2/scrapers** – scrapers ל-Yad2.
- **yad2/mcp** – MCP Server (FastMCP) לשילוב LLM.
- **yad2/cli** – CLI אינטראקטיבי.
- **gis/** – לקוח ArcGIS של תל אביב.
- **gov/** – MCP לגופים ממשלתיים.
- **realestate-broker-ui/** – ה-UI (Next.js).
- **backend-django/** – שרת Backend לניהול, אחסון, API.

### 10. API עיקריים (דוגמה)
| כלי MCP | תיאור |
| --- | --- |
| `search_properties` | ביצוע חיפוש (פרמטרים: topArea, city, neighborhood, priceRange וכו’). |
| `get_search_parameters_reference` | החזרת רשימת פרמטרים אפשריים ותיאורם. |
| `analyze_search_results` | החזרת סטטיסטיקות על תוצאות החיפוש. |
| `save_search_results` | ייצוא תוצאות לקובץ JSON. |
| `build_search_url` | בניית כתובת URL ל-Yad2 ללא ביצוע scraping. |

### 11. אבני דרך ראשוניות
1. **MVP Scraper + CLI** – חיפוש בסיסי, ייצוא JSON.
2. **שילוב MCP Server** – חיפוש בשפה טבעית, תיעוד פרמטרים.
3. **Broker UI v1** – דשבורד לניהול והתראות.
4. **ניתוח מתקדם + GIS/GOV** – חיבור למידע גאוגרפי וממשלתי.
5. **הקשחת אבטחה ושיפורי סקייל** – לוגינג, אופטימיזציה, בדיקות.

### 12. סיכונים ואתגרים
- שינוי HTML באתרי המקור (Yad2) → צורך בעדכונים תכופים.
- מגבלות שימוש ב-API ממשלתיים (הגבלת תדירות, הרשאות).
- טעינת LLM (השגת תוצאות מדויקות) – תלוי במודל ובקונטקסט.
- אבטחת מידע בעת איסוף ושימור נתונים רגישים.

### 13. מדדי הצלחה

#### 13.1 מדדי ביצועים טכניים
- מספר מקורות נתונים פעילים ורמת כיסוי הנתונים (%) מכל מקור.
- זמן תגובה ממוצע לחיפוש (יעד: מתחת ל-3 שניות).
- זמינות המערכת (uptime) - יעד 99.5%.
- מספר עדכונים אוטומטיים של נתונים ביום.

#### 13.2 מדדי שימוש ואימוץ
- מספר מתווכים ושמאים פעילים במערכת.
- תדירות שימוש ממוצעת למשתמש (חיפושים ביום/שבוע).
- שיעור משתמשים חוזרים לעומת משתמשים חדשים.
- מספר דוחות ששוח רק באמצעות המערכת.

#### 13.3 מדדי ערך עסקי למתווכים ושמאים
- חיסכון בזמן מוצהר על ידי המשתמשים (השוואה לשיטות קודמות).
- שיפור ברמת השירות ללקוחות (משוב לקוחות).
- גידול במספר עסקאות שנסגרו עם תמיכת המערכת.
- דיוק הנתונים והשוואות (feedback מהמשתמשים).

#### 13.4 מדדי שביעות רצון
- ציון שביעות רצון כללי (NPS - Net Promoter Score).
- שיעור המלצות למתווכים/שמאים אחרים.
- משוב איכותי על תכונות המערכת והבינה המלאכותית.
- רמת השימוש בתכונות מתקדמות (AI search, ניתוח מגמות).

---

מסמך זה מספק אפיון מלא למערכת Real Estate Agent ויכול לשמש כבסיס לשמירה בקובץ PRD לצורך המשך פיתוח וניהול המוצר.

